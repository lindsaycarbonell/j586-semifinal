<!DOCTYPE html>

<head>
<!--jquery-->
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js" type="text/javascript"></script>
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<!--highcharts-->
<script src="http://code.highcharts.com/highcharts.js"></script>
<!--bootstrap-->
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.4/css/bootstrap.min.css" />

<!--my stylesheet-->
<link href="css/styles.css" rel="stylesheet" type="text/css" />


</head>

<body>
  <nav class="navbar navbar-default navbar-static-top">
    <div class="container">
      <img id="logo" src="http://media.npr.org/chrome/news/nprlogo_138x46.gif" alt="NPR" />
        <ul class="nav navbar-nav">
          <li><a href="#">news</a></li>
          <li><a href="#">arts &#38; life</a></li>
          <li><a href="#">music</a></li>
          <li><a href="#">topics</a></li>
          <li><a href="#">programs</a></li>
          <li><a href="#">listen</a></li>
        </ul>
    </div>
  </nav>

<div class="container">
    <div class="row">
      <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
        <h1>N.C. House of Representatives Blah Blah</h1>
      </div><!--end col-->
    </div><!--end row-->
      <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
        <p class="byline">April 1, 2014 12:00 AM ET</p>
      </div>
</div><!--end container-->

  <hr>

<div class="container">
    <!--BODY-->
    <div class="row">
      <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec fermentum sem diam, eget sodales massa sodales non. Morbi sed purus sapien. Phasellus ex risus, interdum eget nulla et, scelerisque ullamcorper nisl. Phasellus ac lobortis enim. Nulla scelerisque viverra semper. Sed vitae ligula quis elit porta pharetra. Nunc scelerisque sagittis justo ut accumsan. Vivamus ultrices, ligula in feugiat convallis, lacus elit bibendum felis, a interdum augue leo a nibh. Nam accumsan dui vitae nibh consequat mollis.</p>
      </div>
    </div><!--end row-->

    <hr>

</div><!--end header container-->

<div class="container">

  <!--ROW 2-->
  <div class="row">
    <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
      <div class="row">
        <div class="col-lg-4 col-md-4 col-sm-4">
          <p>Choose a representative:</p>
        </div><!--end inner col 1-->
        <div class="col-lg-4 col-md-4 col-sm-4">
          <input class="switch" type="radio" name="g" value="adams">Adams</input>
          <input class="switch" type="radio" name="g" value="butterfield">Butterfield</input>
          <input class="switch" type="radio" name="g" value="foxx">Foxx</input>
          <input class="switch" type="radio" name="g" value="holding">Holding</input>
          <input class="switch" type="radio" name="g" value="hudson">Hudson</input>
          <input class="switch" type="radio" name="g" value="jones">Jones</input>
          <input class="switch" type="radio" name="g" value="mchenrgy">McHenry</input>
          <input class="switch" type="radio" name="g" value="meadows">Meadows</input>
          <input class="switch" type="radio" name="g" value="pittenger">Pittenger</input>
          <input class="switch" type="radio" name="g" value="price">Price</input>
          <input class="switch" type="radio" name="g" value="rouzer">Rouzer</input>
        </div><!--end inner col 2-->
      </div><!--end inner row-->
    </div><!--end col-->
  </div><!--end row-->

  <hr>

  <!--ROW 3-->
  <div class="row">
    <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
      <p>REPRESENTATIVE NAME</p>
    </div><!--end col-->
  </div><!--end row-->

  <!--ROW 4-->
  <div class="row">
    <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
      <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
            <img id="picture" src="images/tillis.jpg" style="height:50%;width:50%;" />
          </div><!--end inner col-->
          <div class="col-lg-8 col-md-8 col-sm-8 col-xs-8">
            <div id="main-graph"></div>
          </div><!--end inner col-->
      </div><!--end inner row-->
    </div><!--end col-->
  </div><!--end row-->

  <!--ROW 5-->
  <div class="row">
    <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
      <div class="row">
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
            <p id="district">DISTRICT</p>
            <p id="party">PARTY</p>
          </div><!--end inner col-->
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
            <div id="pie-graph">pie graph</div>
          </div><!--end inner col-->
          <div class="col-lg-4 col-md-4 col-sm-4 col-xs-4">
            <div id="org-descr">organization descr</div>
          </div><!--end inner col-->
      </div><!--end inner row-->
    </div><!--end col-->
  </div><!--end row-->

  <!--ROW 6-->
  <div class="row">
    <div class="max-width col-lg-10 col-lg-offset-2 col-md-10 col-md-offset-2 col-sm-12">
      <div class="row">
          <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12">
            <div id="tabular">tabular</div>
          </div>
      </div><!--end inner row-->
    </div><!--end col-->
  </div><!--end row-->

</div><!--end body container-->

<script>
var indivs = [];
var totals = [];
var organizationIndex = [];
var organizations = [];
var fullname = "";

$(document).ready(function(){


  $.ajax({
      type: "GET",
      url: "all_reps.xml",
      dataType: "xml",
      success: parseAllReps});

  function parseAllReps(xml){

      $(xml).find('person').each(function(){

          console.log("once for every person");
          var $person = $(this);
          var lastname = $person.find('last_name').text();
          fullname = $person.find('fullname').text();
          var district = $person.find('district').text();
          var party = $person.find('party').text();

      });
    }
      getAll();
});

function getAll(){
    $.ajax({
        type: "GET",
        url: "legislators/adams10.xml",
        dataType: "xml",
        success: parseAdams});

    $.ajax({
        type: "GET",
        url: "legislators/butterfield10.xml",
        dataType: "xml",
        success: parseButterfield});

    $.ajax({
        type: "GET",
        url: "legislators/foxx10.xml",
        dataType: "xml",
        success: parseFoxx});

    $.ajax({
        type: "GET",
        url: "legislators/holding10.xml",
        dataType: "xml",
        success: parseHolding});

    $.ajax({
        type: "GET",
        url: "legislators/hudson10.xml",
        dataType: "xml",
        success: parseHudson()});

    $.ajax({
        type: "GET",
        url: "legislators/jones10.xml",
        dataType: "xml",
        success: parseJones});

    $.ajax({
        type: "GET",
        url: "legislators/mchenry10.xml",
        dataType: "xml",
        success: parseMchenry});

//FIX ALL FILES BELOW HERE
    $.ajax({
        type: "GET",
        url: "legislators/meadows10.xml",
        dataType: "xml",
        success: parseMeadows});

    $.ajax({
        type: "GET",
        url: "legislators/pittenger10.xml",
        dataType: "xml",
        success: parsePittenger});

    $.ajax({
        type: "GET",
        url: "legislators/price10.xml",
        dataType: "xml",
        success: parsePrice});

    $.ajax({
        type: "GET",
        url: "legislators/rouzer10.xml",
        dataType: "xml",
        success: parseRouzer});
}

//parse everything

function chooseChart(){
    console.log("choose chart");
    console.log(organizations);

    var chart = new Highcharts.Chart({
      chart: {
        renderTo: 'main-graph',
        type: 'column'
      },
      series: [{
        data: [0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
      }],

    });


  $('.switch').change(function(){
    console.log("switch function starts");
    var lastName = this.getAttribute("value");

    if(lastName == 'adams'){
      console.log("Adams chart");
      chart.series[0].remove();
      chart.addSeries({
        showInLegend:false,
        type: 'column',
        color: '#08F',
       data: totals
        });
        parseAdams();
    }
    else if (lastName == 'butterfield'){
      console.log("Butterfield chart");
    }

  }); //end switch function
}


function parseAdams(xml) {
  //var i = 0;
  $(xml).find('donation').each(function(){

      console.log("once for every donation");
      var $donation = $(this);
      var pac = $donation.find('pac').text();

      organizations.push($donation.find('organization').text());
      organizationIndex.push(parseInt($donation.find('organization-index').text()));
      indivs.push(parseInt($donation.find('indivs').text()));
      totals.push(parseInt($donation.find('totals').text()));


      //
      // html="";
      //
      // html += '<div id="' + i + '">' + '<p>' + organizations[i] + '</p>' + '<br>' + '<p>' + totals[i] + '</p>' + '</div>';
      //
      // $('#thing').append($(html));
      //
      // i++;
    });
buildChart();

}

function parseButterfield(xml) {
  //var i = 0;
  $(xml).find('donation').each(function(){

      //console.log("once for every donation");
      var $donation = $(this);
      var pac = $donation.find('pac').text();

      organizations.push($donation.find('organization').text());
      organizationIndex.push(parseInt($donation.find('organization-index').text()));
      indivs.push(parseInt($donation.find('indivs').text()));
      totals.push(parseInt($donation.find('totals').text()));



      // html="";
      //
      // html += '<div id="' + i + '">' + '<p>' + organizations[i] + '</p>' + '<br>' + '<p>' + totals[i] + '</p>' + '</div>';
      //i++;
    });
buildChart();


}

function buildChart(){
//THIS IS A THING DOWN HERE IDK
  $('.main-graph').highcharts({



          chart: {
              type: 'column'
          },
          title: {
              text: 'Campaign Donations, totals'
          },
          subtitle: {
              text: 'Source: OpenSecrets.com'
          },
          xAxis: {
              categories: organizations,
              crosshair: true
          },
          yAxis: {
              min: 0,
              title: {
                  text: 'Donations ($)'
              }
          },
          tooltip: {
              headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
              pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                  '<td style="padding:0"><b>${point.y:.1f}</b></td></tr>',
              footerFormat: '</table>',
              shared: true,
              useHTML: true
          },
          plotOptions: {
              column: {
                  pointPadding: 0.2,
                  borderWidth: 0
              }
          },
          legend: {
            enabled:false
          },
          series: [{
              name: 'total donation',
              data: totals
          }]


      }); //end main-graph

}


  </script>




</body>

</html>
